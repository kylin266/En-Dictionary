{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport axios from 'axios';\nimport { StatusBar } from 'expo-status-bar';\nimport { useEffect, useState } from 'react';\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport useWindowDimensions from \"react-native-web/dist/exports/useWindowDimensions\";\nimport { Text, View } from \"../components/Themed\";\nimport RenderHtml from 'react-native-render-html';\nimport { addHistory, getWordBookmarkByWord, openDatabase } from \"../db\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function ModalScreenVi(props) {\n  var _useWindowDimensions = useWindowDimensions(),\n      width = _useWindowDimensions.width;\n\n  var value = props.route.params.value;\n\n  var _useState = useState({}),\n      _useState2 = _slicedToArray(_useState, 2),\n      data = _useState2[0],\n      setData = _useState2[1];\n\n  var _useState3 = useState(value),\n      _useState4 = _slicedToArray(_useState3, 2),\n      title = _useState4[0],\n      setTitle = _useState4[1];\n\n  var _useState5 = useState(''),\n      _useState6 = _slicedToArray(_useState5, 2),\n      err = _useState6[0],\n      setErr = _useState6[1];\n\n  var _useState7 = useState(true),\n      _useState8 = _slicedToArray(_useState7, 2),\n      isMounted = _useState8[0],\n      setMounted = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      favorite = _useState10[0],\n      setFavorite = _useState10[1];\n\n  var api = \"http://m.dict.laban.vn/en_vn/find?keyword=\" + value;\n  useEffect(function () {\n    setTitle(value);\n    console.log(api);\n\n    (function _callee2() {\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _regeneratorRuntime.awrap(axios.get(api).then(function _callee(res) {\n                var db, word;\n                return _regeneratorRuntime.async(function _callee$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        if (!res.data) {\n                          _context.next = 15;\n                          break;\n                        }\n\n                        if (!isMounted) {\n                          _context.next = 14;\n                          break;\n                        }\n\n                        console.log(res.data);\n                        setData(res.data);\n                        setMounted(false);\n                        _context.next = 7;\n                        return _regeneratorRuntime.awrap(openDatabase());\n\n                      case 7:\n                        db = _context.sent;\n                        _context.next = 10;\n                        return _regeneratorRuntime.awrap(getWordBookmarkByWord(db, value));\n\n                      case 10:\n                        word = _context.sent;\n\n                        if (word) {\n                          setFavorite(true);\n                        }\n\n                        _context.next = 14;\n                        return _regeneratorRuntime.awrap(addHistory(db, value));\n\n                      case 14:\n                        ;\n\n                      case 15:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }\n                }, null, null, null, Promise);\n              }).catch(function (err) {\n                setMounted(false);\n                if (err.response) setErr(err.response.data.message);\n              }));\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    })();\n\n    return function () {\n      setMounted(false);\n    };\n  }, []);\n  return _jsxs(ScrollView, {\n    style: styles.container,\n    children: [!!isMounted && _jsx(ActivityIndicator, {\n      color: \"#fff\"\n    }), _jsx(View, {\n      style: styles.separator,\n      lightColor: \"#eee\",\n      darkColor: \"rgba(255,255,255,0.1)\"\n    }), _jsx(RenderHtml, {\n      contentWidth: width,\n      source: {\n        html: data\n      }\n    }), data && _jsx(Text, {\n      style: styles.title,\n      children: err\n    }), _jsx(StatusBar, {\n      style: Platform.OS === 'ios' ? 'light' : 'auto'\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    marginTop: 10\n  },\n  title: {\n    fontSize: 20,\n    textAlign: 'center',\n    fontWeight: 'bold'\n  },\n  separator: {\n    marginVertical: 10,\n    height: 1,\n    width: '80%'\n  }\n});","map":{"version":3,"names":["axios","StatusBar","useEffect","useState","Text","View","RenderHtml","addHistory","getWordBookmarkByWord","openDatabase","ModalScreenVi","props","useWindowDimensions","width","value","route","params","data","setData","title","setTitle","err","setErr","isMounted","setMounted","favorite","setFavorite","api","console","log","get","then","res","db","word","catch","response","message","styles","container","separator","html","Platform","OS","StyleSheet","create","flex","marginTop","fontSize","textAlign","fontWeight","marginVertical","height"],"sources":["/Users/littlecorn/Documents/en-dictionary/screens/ModalScreenVi.tsx"],"sourcesContent":["import axios from 'axios';\nimport { StatusBar } from 'expo-status-bar';\nimport { useEffect, useState } from 'react';\nimport { Platform, StyleSheet, ActivityIndicator, ScrollView, Pressable,useWindowDimensions } from 'react-native';\nimport { FontAwesome } from '@expo/vector-icons';\nimport { Text, View } from '../components/Themed';\nimport SearchTextInfo from '../components/SearchTextInfo';\nimport { WebView } from 'react-native-webview';\nimport wordData from '../words.json';\nimport RenderHtml from 'react-native-render-html';\nimport { addHistory, deleteBookmark, getWordBookmarkByWord, getWordHistoryByWord, insertBookmark, openDatabase } from '../db';\nexport default function ModalScreenVi(props: any) {\n  const {width} = useWindowDimensions();\n  const { value } = props.route.params;\n  const [data, setData] = useState({} as any);\n  const [title, setTitle] = useState(value);\n  const [err, setErr] = useState('');\n  const [isMounted, setMounted] = useState(true);\n  const [favorite, setFavorite] = useState(false);\n  let api = `http://m.dict.laban.vn/en_vn/find?keyword=${value}`\n  useEffect(() => {\n    setTitle(value);\n    console.log(api);\n    (async () => {\n      await axios.get(api).then(async res => {\n        if (res.data) {\n          if (isMounted) {\n            console.log(res.data);\n            setData(res.data); setMounted(false);\n            const db = await openDatabase();\n\n            const word = await getWordBookmarkByWord(db, value);\n            if (word) {\n              setFavorite(true);\n            }\n            await addHistory(db, value);\n          };\n        }\n      }).catch(err => {\n        setMounted(false)\n        if (err.response)\n          setErr(err.response.data.message);\n      })\n    })();\n\n    return () => {\n      setMounted(false);\n    };\n  }, [])\n  return (\n\n    <ScrollView style={styles.container}>\n      {!!isMounted && <ActivityIndicator color={\"#fff\"} />}\n      <View style={styles.separator} lightColor=\"#eee\" darkColor=\"rgba(255,255,255,0.1)\" />\n      <RenderHtml\n      contentWidth={width}\n      source={{html: data}}\n    />\n      {data && <Text style={styles.title}>{err}</Text>}\n      {/* Use a light status bar on iOS to account for the black space above the modal */}\n      <StatusBar style={Platform.OS === 'ios' ? 'light' : 'auto'} />\n    </ScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    marginTop: 10\n  },\n  title: {\n    fontSize: 20,\n    textAlign: 'center',\n    fontWeight: 'bold',\n  },\n  separator: {\n    marginVertical: 10,\n    height: 1,\n    width: '80%',\n  },\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}